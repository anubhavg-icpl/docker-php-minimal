pkgname=php
pkgver=7.1.0beta2
pkgrel=1
arch=('i686' 'x86_64')
license=('PHP')
url='http://www.php.net'
source=("https://downloads.php.net/~davey/php-${pkgver}.tar.gz")
md5sums=('7a89ec92011a6eb60ea34ae96912ac20')

build() {
    cd ${pkgname}-${pkgver}

    ./configure --config-cache \
        --prefix=/usr \
        --sbindir=/usr/bin \
        --sysconfdir=/etc/php \
        --localstatedir=/var \
        --with-layout=GNU \
        --with-config-file-path=/etc/php \
        --with-config-file-scan-dir=/etc/php/conf.d \
        --disable-rpath \
        --mandir=/usr/share/man \
        --disable-cgi \
        --disable-all
    make
}

package() {
    pkgdesc='An HTML-embedded scripting language'
    depends=('pcre' 'bzip2')
    backup=('etc/php/php.ini')

    cd ${pkgname}-${pkgver}
    make -j1 INSTALL_ROOT=${pkgdir} install
    install -D -m644 php.ini-production ${pkgdir}/etc/php/php.ini
    install -d -m755 ${pkgdir}/etc/php/conf.d/

    # remove empty directory
    rmdir ${pkgdir}/usr/include/php/include
}
